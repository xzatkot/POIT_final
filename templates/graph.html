<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Flask-SocketIO Test</title>
    <style type="text/css">           
    </style>
    <script src="static/libs/jquery-1.11.1.min.js"></script>
    <script src="static/libs/plotly-latest.min.js"></script>

  <script>
   $(document).ready(function(){
    var layout = {
          title: 'Output variable',
          xaxis: {
            title: 'time',
            range: [0,30]
          },
          yaxis: {
            title: 'ys(t)',
            range: [0,1200]
          }
        };

    //$('#row').change(function() {
        //$.ajax({
          //type: "GET",
          //url: "/dbdata/"+$(this).val(),
          //success:function(data) 
          //{ console.log(data);
            //data = JSON.parse(data);
            //console.log(data);
            
            //xl = [];
            //yl = [];
            
            //$('#data')[0].innerText="";
    
            //data.forEach(function(entry) {
              //xl.push(entry['x']);
              //yl.push(entry['data']);
              //$('#data')[0].innerText+="x: "+entry['x']+", distance: "+entry['data']+"\n";
            //});
            //let trace = {
                //x: xl,
                //y: yl,
                //mode: 'lines',
                //type: 'scatter',
                //name: 'distance' };
            //console.log(trace);
            //Plotly.newPlot($('#plotdiv')[0], [trace], layout);         
          //}
        //}).done(function( o ) {
           //// do something
        //});    
       //});   
    //});
    
    $('#database').click(function() {
        $.ajax({
          type: "GET",
          url: "/dbdata/"+$('#row').val(),
          success:function(data) 
          { console.log(data);
            data = JSON.parse(data);
            console.log(data);
            
            xl = [];
            yl = [];
            
            $('#data')[0].innerText="";
    
            data.forEach(function(entry) {
              xl.push(entry['x']);
              yl.push(entry['data']);
              $('#data')[0].innerText+="x: "+entry['x']+", distance: "+entry['data']+"\n";
            });
            let trace = {
                x: xl,
                y: yl,
                mode: 'lines',
                type: 'scatter',
                name: 'distance' };
            console.log(trace);
            Plotly.newPlot($('#plotdiv')[0], [trace], layout);         
          }
        }).done(function( o ) {
           // do something
        });
    });
    
    $('#file').click(function() {
        $.ajax({
          type: "GET",
          url: "/read/"+$('#row').val(),
          success:function(data) 
          { console.log(data);
            data = JSON.parse(data);
            console.log(data);
            
            xl = [];
            yl = [];
            
            $('#data')[0].innerText="";
    
            data.forEach(function(entry) {
              xl.push(entry['x']);
              yl.push(entry['data']);
              $('#data')[0].innerText+="x: "+entry['x']+", distance: "+entry['data']+"\n";
            });
            let trace = {
                x: xl,
                y: yl,
                mode: 'lines',
                type: 'scatter',
                name: 'distance' };
            console.log(trace);
            Plotly.newPlot($('#plotdiv')[0], [trace], layout);         
          }
        }).done(function( o ) {
           // do something
        });
    });
    });
  </script>
</head>
<body>
    <label for="row">Cislo zaznamu:</label>
    <input id="row" name="row" type="text">
    <button id="database" type="submit">from DB</button>
    <button id="file" type="submit">from file</button>
    <div id="plotdiv" style="width:600px;height:500px;"></div>
    <div id="data"></div>
</body>
</html> 
